
{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "type": "object",
      "description": "Represents a user of the application, who can be a citizen or an admin.",
      "properties": {
        "uid": { "type": "string", "description": "The unique ID of the user, matching their Firebase Auth UID." },
        "name": { "type": "string", "description": "The user's full name." },
        "email": { "type": "string", "format": "email", "description": "The user's email address." },
        "phone": { "type": "string", "description": "The user's phone number." },
        "address": { "type": "string", "description": "The user's full address." },
        "dateJoined": { "type": "string", "format": "date-time", "description": "The date the user signed up." },
        "role": { "type": ["string", "null"], "enum": ["super_admin", "waste_admin", "pothole_admin", "streetlight_admin", "water_admin", null], "description": "The user's role. Null indicates a regular citizen." },
        "department": { "type": "string", "enum": ["Waste Management", "Potholes", "Streetlight Outage", "Water Logging", "Other"], "description": "The department an admin belongs to, if applicable." },
        "bannedUntil": { "type": ["string", "null"], "description": "If the user is banned, this holds the ban's expiration date or 'lifetime'." }
      },
      "required": ["uid", "name", "email", "dateJoined", "role", "phone", "address"]
    },
    "IssueReport": {
      "title": "Issue Report",
      "type": "object",
      "description": "Represents an issue reported by a citizen.",
      "properties": {
        "citizenId": { "type": "string", "description": "The UID of the user who submitted the report." },
        "complainantName": { "type": "string", "description": "The name of the person who filed the report." },
        "complainantPhone": { "type": "string", "description": "The phone number of the person who filed the report." },
        "locationAddress": { "type": "string", "description": "The address or landmark where the issue is located." },
        "category": { "type": "string", "enum": ["Waste Management", "Potholes", "Streetlight Outage", "Water Logging", "Other"] },
        "description": { "type": "string" },
        "imageUrl": { "type": "string", "format": "uri" },
        "reportDate": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["Pending", "In Progress", "Resolved", "Rejected", "Pending Approval", "Pending Citizen Feedback"] },
        "urgency": { "type": "string", "enum": ["Low", "Medium", "High", "Critical"] },
        "assignedAdminId": { "type": "string" },
        "assignedAdminName": { "type": "string" },
        "upvotes": { "type": "number" },
        "citizenIdsWhoUpvoted": { "type": "array", "items": { "type": "string" } },
        "resolution": {
          "type": "object",
          "properties": {
            "adminId": { "type": "string" },
            "adminName": { "type": "string" },
            "date": { "type": "string", "format": "date-time" },
            "summary": { "type": "string" },
            "cost": { "type": "number" },
            "costBreakdown": { "type": "string" },
            "afterImageUrl": { "type": "string", "format": "uri" },
            "citizenFeedback": { "type": "string" },
            "citizenRating": { "type": "number" },
            "superAdminFeedback": { "type": "string" },
            "superAdminRating": { "type": "number" },
            "isApproved": { "type": "boolean" }
          },
          "required": ["adminId", "adminName", "date", "summary", "cost", "costBreakdown"]
        }
      },
      "required": ["citizenId", "complainantName", "complainantPhone", "locationAddress", "category", "description", "reportDate", "status", "upvotes", "citizenIdsWhoUpvoted"]
    },
    "AdminCredential": {
        "title": "Admin Credential",
        "type": "object",
        "description": "Defines an authorized administrator's role and department, keyed by their email.",
        "properties": {
            "role": { "type": "string", "enum": ["super_admin", "waste_admin", "pothole_admin", "streetlight_admin", "water_admin"], "description": "The administrative role assigned to the user." },
            "department": { "type": "string", "enum": ["Waste Management", "Potholes", "Streetlight Outage", "Water Logging", "Other"], "description": "The specific department the admin belongs to." }
        },
        "required": ["role"]
    },
    "Alert": {
      "title": "Platform Alert",
      "type": "object",
      "description": "Represents a platform-wide alert sent by an administrator.",
      "properties": {
        "title": { "type": "string", "description": "The title of the alert." },
        "description": { "type": "string", "description": "The detailed message of the alert." },
        "level": { "type": "string", "enum": ["Info", "Warning", "Critical"], "description": "The severity level of the alert." },
        "publishDate": { "type": "string", "format": "date-time", "description": "The date and time the alert was published." },
        "adminId": { "type": "string", "description": "The UID of the admin who published the alert." },
        "adminName": { "type": "string", "description": "The name of the admin who published the alert." }
      },
      "required": ["title", "description", "level", "publishDate", "adminId", "adminName"]
    }
  },
  "firestore": {
    "'/users/{userId}'": {
      "schema": { "$ref": "#/entities/UserProfile" },
      "description": "Stores public profiles for all users (citizens and admins)."
    },
    "'/issueReports/{reportId}'": {
      "schema": { "$ref": "#/entities/IssueReport" },
      "description": "Stores all issue reports submitted by citizens."
    },
    "'/admins/{email}'": {
      "schema": { "$ref": "#/entities/AdminCredential" },
      "description": "A list of authorized administrators, keyed by email, defining their roles and departments."
    },
    "'/alerts/{alertId}'": {
      "schema": { "$ref": "#/entities/Alert" },
      "description": "Stores all platform-wide alerts published by administrators."
    }
  },
  "auth": {
    "providers": ["password"]
  }
}
