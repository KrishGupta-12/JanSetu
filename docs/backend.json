
{
  "entities": {
    "UserProfile": {
      "title": "User Profile",
      "type": "object",
      "description": "Represents a user of the application, who can be a citizen or an admin.",
      "properties": {
        "uid": { "type": "string", "description": "The unique ID of the user, matching their Firebase Auth UID." },
        "name": { "type": "string", "description": "The user's full name." },
        "email": { "type": "string", "format": "email", "description": "The user's email address." },
        "phone": { "type": "string", "description": "The user's phone number." },
        "address": { "type": "string", "description": "The user's full address." },
        "dateJoined": { "type": "string", "format": "date-time", "description": "The date the user signed up." },
        "role": { "type": "string", "enum": ["super_admin", "waste_admin", "pothole_admin", "streetlight_admin", "water_admin", "citizen"], "description": "The user's role." },
        "department": { "type": "string", "enum": ["Waste Management", "Potholes", "Streetlight Outage", "Water Logging", "Other"], "description": "The department an admin belongs to, if applicable." },
        "bannedUntil": { "type": ["string", "null"], "description": "If the user is banned, this holds the ban's expiration date or 'lifetime'." },
        "totalReports": { "type": "number", "description": "The total number of reports submitted by the user." },
        "resolvedReports": { "type": "number", "description": "The number of reports submitted by the user that have been resolved." }
      },
      "required": ["uid", "name", "email", "dateJoined", "role", "phone", "address", "totalReports", "resolvedReports"]
    },
    "IssueReport": {
      "title": "Issue Report",
      "type": "object",
      "description": "Represents an issue reported by a citizen.",
      "properties": {
        "citizenId": { "type": "string", "description": "The UID of the user who submitted the report." },
        "complainantName": { "type": "string", "description": "The name of the person who filed the report." },
        "complainantPhone": { "type": "string", "description": "The phone number of the person who filed the report." },
        "locationAddress": { "type": "string", "description": "The address or landmark where the issue is located." },
        "category": { "type": "string", "enum": ["Waste Management", "Potholes", "Streetlight Outage", "Water Logging", "Other"] },
        "description": { "type": "string" },
        "imageUrl": { "type": "string", "format": "uri" },
        "reportDate": { "type": "string", "format": "date-time" },
        "status": { "type": "string", "enum": ["Pending", "In Progress", "Resolved", "Rejected", "Pending Approval", "Pending Citizen Feedback"] },
        "urgency": { "type": "string", "enum": ["Low", "Medium", "High", "Critical"] },
        "assignedAdminId": { "type": "string" },
        "assignedAdminName": { "type": "string" },
        "upvotes": { "type": "number" },
        "citizenIdsWhoUpvoted": { "type": "array", "items": { "type": "string" } },
        "resolution": {
          "type": "object",
          "properties": {
            "adminId": { "type": "string" },
            "adminName": { "type": "string" },
            "date": { "type": "string", "format": "date-time" },
            "summary": { "type": "string" },
            "cost": { "type": "number" },
            "costBreakdown": { "type": "string" },
            "afterImageUrl": { "type": "string", "format": "uri" },
            "citizenFeedback": { "type": "string" },
            "citizenRating": { "type": "number" },
            "superAdminFeedback": { "type": "string" },
            "superAdminRating": { "type": "number" },
            "isApproved": { "type": "boolean" }
          },
          "required": ["adminId", "adminName", "date", "summary", "cost", "costBreakdown"]
        }
      },
      "required": ["citizenId", "complainantName", "complainantPhone", "locationAddress", "category", "description", "reportDate", "status", "upvotes", "citizenIdsWhoUpvoted"]
    },
    "Leaderboard": {
      "title": "Leaderboard",
      "type": "object",
      "description": "Holds the pre-calculated list of top contributors.",
      "properties": {
        "lastUpdated": { "type": "string", "format": "date-time" },
        "users": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "uid": { "type": "string" },
              "name": { "type": "string" },
              "score": { "type": "number" },
              "totalReports": { "type": "number" },
              "resolvedReports": { "type": "number" }
            },
            "required": ["uid", "name", "score", "totalReports", "resolvedReports"]
          }
        }
      },
      "required": ["lastUpdated", "users"]
    },
    "SuperAdmin": {
        "title": "Super Admin",
        "type": "object",
        "description": "A document indicating that the user is a super admin. The document ID should be the user's UID.",
        "properties": {
            "isAdmin": { "type": "boolean", "const": true }
        },
        "required": ["isAdmin"]
    },
    "Alert": {
      "title": "Platform Alert",
      "type": "object",
      "description": "Represents a platform-wide alert sent by an administrator.",
      "properties": {
        "title": { "type": "string", "description": "The title of the alert." },
        "description": { "type": "string", "description": "The detailed message of the alert." },
        "level": { "type": "string", "enum": ["Info", "Warning", "Critical"], "description": "The severity level of the alert." },
        "publishDate": { "type": "string", "format": "date-time", "description": "The date and time the alert was published." },
        "adminId": { "type": "string", "description": "The UID of the admin who published the alert." },
        "adminName": { "type": "string", "description": "The name of the admin who published the alert." }
      },
      "required": ["title", "description", "level", "publishDate", "adminId", "adminName"]
    }
  },
  "firestore": {
    "'/users/{userId}'": {
      "schema": { "$ref": "#/entities/UserProfile" },
      "description": "Stores public profiles for all users (citizens and admins)."
    },
    "'/issueReports/{reportId}'": {
      "schema": { "$ref": "#/entities/IssueReport" },
      "description": "Stores all issue reports submitted by citizens."
    },
    "'/superAdmins/{userId}'": {
      "schema": { "$ref": "#/entities/SuperAdmin" },
      "description": "A list of super administrators, keyed by their UID. The existence of a document here grants super admin privileges."
    },
    "'/alerts/{alertId}'": {
      "schema": { "$ref": "#/entities/Alert" },
      "description": "Stores all platform-wide alerts published by administrators."
    },
    "'/leaderboard/{leaderboardId}'": {
      "schema": { "$ref": "#/entities/Leaderboard" },
      "description": "Stores the pre-calculated leaderboard data. Should only contain one document."
    }
  },
  "auth": {
    "providers": ["password"]
  }
}

    